<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Michal Szekely">
    <meta name="description" content="Využitie NoSQL databáz v súčasných webových aplikáciách. [Bakalárska práca]. Univerzita Konštantína Filozofa v Nitre. Fakulta prírodných vied. ">
    <meta name="keywords" content="MongoDB, NoSQL, Model kľúč-hodnota, Model rodiny stĺpcov, Dokumentový model, Grafový model, JavaScript, Relačné databázy, Aggregate, Map_reduce  ">
    <title>...: Nosql.sk :...</title>
    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/small-business.css" rel="stylesheet">
    <link href="css/one-page-wonder.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">    
    <link href="css/freelancer.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">
                    <img src="_grf/logo.png" alt="">
                </a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="index.html">Home</a></li>
                    <li class="page-scroll"><a href="about.html">O nás</a></li>
                    <li class="page-scroll"><a href="clanky.html">NoSQL Novinky</a></li>
                    <li class="page-scroll"><a href="download.html">Download</a></li>
                    <li class="page-scroll"><a href="cl1.html">Apache dashboard</a></li>                  
                    <li class="page-scroll"><a href="contact.html">Kontakt</a></li>                  
                </ul>
            </div>
           <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>


    <!-- Page Content -->
    <div class="container">

<div>
 
<a href="#3"><b>3          Webová aplikácia využívajúca NoSQL databázu</a></b><br>   
&nbsp; <a href="#3.1">3.1               Výber programovacieho jazyka a NoSQL databázy</a><br>   
&nbsp; <a href="#3.2">3.2               Etapy riešenia problému</a><br>   
&nbsp;&nbsp; <a href="#3.2.1">3.2.1                Definovanie hardvérových a softvérových požiadaviek</a><br>
&nbsp;&nbsp; <a href="#3.2.2">3.2.2                Inštalovanie databázy a frameworku</a><br>   
&nbsp;&nbsp; <a href="#3.2.3">3.2.3                Definovanie požiadaviek na výstupné údaje</a><br>   
&nbsp; <a href="#3.3">3.3               Tvorba aplikácie</a><br>   
&nbsp;&nbsp; <a href="#3.3.1">3.3.1                Definovanie a generovanie vstupných údajov, t.j. záznamov</a><br>   
&nbsp;&nbsp; <a href="#3.3.2">3.3.2                Vloženie záznamov do MongoDB</a><br>   
&nbsp;&nbsp; <a href="#3.3.3">3.3.3                Získanie požadovaných vstupných údajov z MongoDB</a><br>   
&nbsp;&nbsp; <a href="#3.3.4">3.3.4                Štatistické spracovanie záznamov</a><br>   
&nbsp;&nbsp; <a href="#3.3.5">3.3.5                Spustenie webovej aplikácie</a><br>   
&nbsp; <a href="#3.4">3.4               Porovnanie rýchlosti spracovania záznamov</a><br>   


            </div>

        <hr> 

        <!-- Pagination -->
        <div class="row text-center">
            <div class="col-lg-12">
                <ul class="pagination">
                    <li>
                        <a href="cl1.html">&laquo;</a>
                    </li>
                    <li>
                        <a href="cl1.html">1</a>
                    </li>
                    <li class="active">
                        <a href="cl2.html">2</a>
                    </li>
                    <li>
                        <a href="cl3.html">3</a>
                    </li>
                    <li>
                        <a href="cl4.html">4</a>
                    </li>
                    <li>
                        <a href="cl3.html">&raquo;</a>
                    </li>
                </ul>
            </div>
        </div>

        <hr>

        <!-- First Featurette -->
        <div class="featurette" id="3">
             <h2 class="featurette-heading">3 Webová aplikácia využívajúca NoSQL databázu</h2>
            <p class="lead2">
V praktickej časti našej bakalárskej práce sa venujeme tvorbe webovej aplikácie, ktorá spracováva dáta uložené v NoSQL databáze. V teoretickej časti sme preto s použitím dostupnej literatúry (uverejnenej hlavne na internete) popísali a analyzovali hlavné rozdiely medzi relačnými databázami a NoSQL databázami, uviedli dôvody použitia NoSQL databáz, ich klady a zápory. Bližšie sme charakterizovali jednotlivých zástupcov NoSQL. 
            </p>
        </div>

        <hr>
        
        
        <div class="featurette" id="3.1">
             <h2 class="featurette-heading">3.1               Výber programovacieho jazyka a NoSQL databázy</h2>
            <p class="lead2">
Pre napísanie našej webovej aplikáciu sme sa rozhodli použiť programovací jazyk JavaScript. 
Použitie JavaScriptu odporúčajú experti z rôznych dôvodov (napr. extrémna rýchlosť pri vstupno-výstupných operáciách), pre nás boli pri tvorbe modulov rozhodujúcimi argumentmi: 

<br> 
 &bull; časová efektívnosť tvorby, <br> 
 &bull; použitie iba jedného programovacieho jazyka,<br> 
 &bull; možná variabilita, <br> 
 &bull; bezkonfliktnosť implementácie z hľadiska syntaxe.
 
<br> <br> 
Ako reprezentanta rodiny NoSQL dokumentových databáz sme pre naše účely vybrali jedného z niekoľkých možných zástupcov (OrientDB, CouchDB, RavenDB), a to MongoDB.
<br><br> 
<b> Ide o:</b>
<br> 
 &bull; v praxi najčastejšie používanú JavaSkriptovú databázu, <br> 
 &bull; nielen podľa nás aj najlepšie zdokumentovanú, <br> 
 &bull; súčasne v škole odprednášanú.<br> 


            </p>
        </div>

        <hr>
        
        <div class="featurette" id="3.2">
             <h2 class="featurette-heading">3.2               Etapy riešenia problému</h2>
            <p class="lead2">
<b>Postup riešenia problému sme rozdelili do nasledujúcich etáp. </b>
<br> 
&bull;      Definovanie hardvérových a softvérových požiadaviek.<br> 
&bull;      Inštalovanie operačného systému.<br> 
&bull;      Inštalovanie databázy a frameworku.<br> 
&bull;      Definovanie požiadaviek na výstupné údaje.<br> 
&bull;      Tvorba aplikácie.  <br> 
&bull;      Porovnanie rýchlosti spracovania záznamov funkciami Aggregate a Map_reduce.<br> 
            </p>
        </div>

        <hr>   

        <div class="featurette" id="3.2.1">
             <h2 class="featurette-heading">3.2.1                Definovanie hardvérových a softvérových požiadaviek</h2>
            <p class="lead2">
<b>Pre spustenie resp. overenie funkčnosti aplikácie postačuje počítač s nasledujúcimi, minimálnymi hardvérovými parametrami:</b>
<br> 
&bull;      64 bitový procesor s taktovacou frekvenciou 2,13 GHz, 2 jadrový (v našom prípade použitý Intel Atom),<br> 
&bull;      pamäť RAM: 4 GB,<br> 
&bull;      požadované miesto na HDD: 20 GB.  <br> 

<br> <b>Softvérové požiadavky nami vytvorenej aplikácie:</b>
<br> 
&bull;      operačný systém: CentOS Linux 7.2 (voľné dostupný, stabilný a používateľmi Linuxu odporúčaný 64 bitový OS), <br> 
&bull;      databáza MongoDB,<br> 
&bull;      framework Node.JS (v praxi bežne používaný podporný program, obľúbený hlavne pre jeho možnosti v realizácii vstupno-výstupných operácií).<br> 
            </p>
        </div>

        <hr>
        
        <div class="featurette" id="3.2.2">
             <h2 class="featurette-heading">3.2.2                Inštalovanie databázy a frameworku</h2>
            <p class="lead2">
Proces inštalácie a spustenia MongoDB je štandardným. Okrem MongoDB je nutné nainštalovať framework Node.JS resp. jeho komponenty node a mpm. 
            </p>
        </div>

        <hr>
        
        <div class="featurette" id="3.2.3">
             <h2 class="featurette-heading">3.2.3                Definovanie požiadaviek na výstupné údaje</h2>
            <p class="lead2">
<b>Požadované výstupné údaje predstavujú: </b>
<br> 
&bull;      počet návštev stránky za deň, v hodinových intervaloch, za týždeň, za mesiac, za rok, <br> 
&bull;      počet použití rôznych internetových prehliadačov a operačných systémov za konkrétny deň, <br> 
&bull;      počet zobrazení sledovaných webových stránok, <br> 
&bull;      regionálne rozloženie návštevnosti.<br> 
<br> 
Požadované výstupné údaje predstavujú reálne požiadavky majiteľov resp. administrátorov stránok. Ich dôvody, prečo získať požadované údaje, sú rôzne, medzi hlavné patria optimalizácia stránky pre konkrétne, návštevníkmi stránok najviac používané prehliadače, súčasne pre optimálne načasovanie svojich kampaní (deň, hodina, mesiac), v neposlednom rade i nutnosti vyrobiť resp. nevyrobiť jazykové mutácie svojich webových stránok.

            </p>
        </div>

        <hr>
        
        <div class="featurette" id="3.3">
             <h2 class="featurette-heading">3.3               Tvorba aplikácie</h2>
            <p class="lead2">
Celá naša aplikácia je vlastne štandardnou lineárnou štruktúrou, pre ktorú je typická nasledujúca postupnosť krokov: vstup údajov, spracovanie údajov a výstup údajov (obrázok 4).  

        <center>
     Obrázok 4:  Všeobecný vývojový diagram programu typický aj pre našu webovú aplikáciu <br> 
<img src="_grf/apache/image004.png">
           </center>  


            </p>
        </div>

        <hr>
          
        <div class="featurette" id="3.3.1">
             <h2 class="featurette-heading">3.3.1                Definovanie a generovanie vstupných údajov, t.j. záznamov</h2>
            <p class="lead2">
Vstupné údaje predstavuje 700 IP adries, 15 najpoužívanejších internetových prehliadačov a 40 webových stránok. Medzi vstupné údaje patria aj nami náhodne generované záznamy, v reálnej praxi predstavujúce prístupy konkrétnych používateľov využívajúcich konkrétny internetový prehliadač na konkrétnu webovú stránku.
<br> 
V prípade 700 IP adries ide o reálne IP adresy získané stiahnutím zo spravovaných webových stránok. Pre potreby overenia funkčnosti aplikácie považujeme ich množstvo za dostatočné (pôvodne bola aplikácia testovaná pre 150 adries). Webové stránky, podobne ako IP adresy, sú už niekoľko rokov v praxi využívané ako webové a produktové vizitky firiem poskytujúcich služby pre verejnosť.
<br> 
Nami náhodne generované záznamy obsahujú dáta, ktoré sú reálne k dispozícií pri použití webového servera Apache http Server. 
<br><br> 
<b>Ide o:</b>
<br> 
&bull; <b>_id:</b> jednoznačný identifikátor záznamu v databáze MongoDB,<br> 
&bull; <b>host:</b> IP adresa používateľa, ktorý webovú stránku navštívil,<br> 
&bull; <b>time:</b> dátum a čas, v akom sa používateľovi stránka zobrazila v jeho internetovom prehliadači,<br> 
&bull; <b>path:</b> obsahuje prenosový protokol, metódu prenosu a adresu navštívenej stránky,<br> 
&bull; <b>agent:</b> obsahuje informácie o použitom internetovom prehliadači a operačnom systéme,<br> 
&bull; <b>status:</b> stavový (návratový) kód http. Určuje ako prebehla komunikácia medzi klientom a serverom,<br> 
&bull; <b>size:</b> veľkosť dát poskytnutých klientovi,<br> 
&bull; <b>_v:</b> obsahuje vnútornú revíziu dokumentu. Parameter je vytvorený automaticky.

<br> <br> 
Náhodne generované dáta  sú obsahom NoSQL databázy MongoDB, ktorá je umiestnená na 1 počítači, čo je pre overenie jej možností využitia postačujúce. V reálnej praxi by spracovanie dát prebiehalo na viacerých serveroch súčasne a obsah originálnej databázy by bol replikovaný na niekoľkých serveroch. Takáto funkcionalita, ktorá v prípade klasických SQL databáz nie je možná, mimoriadne zvýši rýchlosť spracovania a zabezpečí požadovanú, t.j. redundantnú dostupnosť databázových údajov.
            </p>
        </div>

        <hr>     

        <div class="featurette" id="3.3.2">
             <h2 class="featurette-heading">3.3.2                Vloženie záznamov do MongoDB</h2>
            <p class="lead2">
Je realizované prostredníctvom JavaScriptu. Uvádzame časť skriptu, ktorou sa realizuje vkladanie záznamov do databázy.


<p class="scripty">
mongoose.connect(database);<br> 
let entries = 0;<br> 
for (let i = 0; i < MAX_ENTRIES; i++) {<br> 
    const logEntry = {<br> 
        host: randomElement(ipAddresses),<br> 
        time: randomTime(),<br> 
        path: 'GET ' + randomElement(pageLinks) + ' HTTP/1.0',<br> 
        agent: randomElement(userAgents),<br> 
        status: 200,<br> 
        size: randomNum(1000, 10000)<br> 
    };<br> 
    accessLog.create(logEntry)<br> 
        .then(() => {<br> 
            entries++;<br> 
            if (entries === MAX_ENTRIES) {<br> 
                console.log('All data were successfully saved into database.');<br> 
                mongoose.disconnect();<br> 
            }<br> 
        })<br> 
        .catch((err) => {<br> 
            console.error('Cannot write to the database! ' + err);<br> 
            mongoose.disconnect();<br> 
            process.exit(1);<br> 
    });<br> 
}<br> 
</p>
            </p>
        </div>

        <hr> 
        
        
        <div class="featurette" id="3.3.3">
             <h2 class="featurette-heading">3.3.3                Získanie požadovaných vstupných údajov z MongoDB</h2>
            <p class="lead2">
Je realizované prostredníctvom JavaScriptu. Z dôvodu názornosti uvádzame skript, ktorý spočíta celkový počet záznamov v databáze.
    
<p class="scripty">
var MongoClient = require('mongodb').MongoClient;<br> 
 MongoClient.connect("mongodb://localhost:27017/apache", function(err, db) {<br> 
 var collection = db.collection('accesslogs');<br> 
 var count = collection.count();
<br> <br> 

 collection.count(function(err, count) {<br> 
     console.log(count);<br> 
     db.close();<br> 
   });<br> 
 });
 
<br> 
</p>        
            </p>
        </div>

        <hr> 

        <div class="featurette" id="3.3.4">
             <h2 class="featurette-heading">3.3.4                Štatistické spracovanie záznamov</h2>
            <p class="lead2">
Štatistické spracovanie databázových údajov je súčasťou každého z nami vytvorených modulov, pričom jednotlivé moduly predstavujú elementárne požiadavky používateľov webových stránok. 

<br><br> 
<b>Ide o moduly: </b>
<br> 
&bull;      <b>Aktivita </b>– spĺňa požiadavku informovať používateľa o počte návštevníkov, počte unikátnych návštevníkov, počte zobrazených stránok a množstve dát poskytnutých klientov v priebehu konkrétneho, požadovaného dňa.
<br> 
&bull;      <b>Deň</b> – spĺňa požiadavku informovať používateľa o počte návštevníkov v priebehu konkrétneho, požadovaného dňa. Ide o zjednodušenú formu modulu Aktivita doplnenú o tabuľku zobrazujúcu požadované v hodinových intervaloch. 
<br> 
&bull;      <b>Týždeň </b>– spĺňa požiadavku informovať používateľa o počte návštevníkov v priebehu konkrétneho, požadovaného týždňa od pondelku do nedele. 
<br> 
&bull;      <b>Mesiac</b>– spĺňa požiadavku informovať používateľa o počte návštevníkov v priebehu konkrétneho mesiaca. Výsledky sú rozdelené podľa týždňov v požadovanom mesiaci.
<br> 
&bull;      <b>Rok </b>– spĺňa požiadavku informovať používateľa o počte návštevníkov v priebehu požadovaného kalendárneho roka. Výsledky sú rozdelené podľa mesiacov v roku.
<br> 
&bull;      <b>Top regióny </b>– spĺňa požiadavku informovať používateľa o štátnej príslušnosti návštevníkov stránky resp. lokalizácie IP adresy návštevníka.
<br> 
&bull;      <b>Najpoužívanejšie prehliadače </b>– spĺňa požiadavku informovať používateľa o návštevníkmi využívaných internetových prehliadačoch. Rôzne verzie toho istého prehliadača aplikácia sumarizuje na jeden. Pre zvýšenie prehľadnosti je okrem tabuľky používateľovi k dispozícii aj koláčový diagram.
<br> 
&bull;      <b>Najpoužívanejšie operačné systémy (OS)</b> – spĺňa požiadavku informovať používateľa o návštevníkmi využívaných operačných systémoch (OS). Rôzne verzie toho istého OS aplikácia sumarizuje na jeden. Pre zvýšenie prehľadnosti je okrem tabuľky používateľovi k dispozícii i koláčový diagram.
<br> 
&bull;      <b>Najnavštevovanejšie stránky a súbory </b>– spĺňa požiadavku informovať používateľa o navštívených stránkach a prezeraných súboroch. Z dôvodu kompletnosti tiež obsahuje prenosový protokol a metódu prenosu.

       
            </p>
        </div>

        <hr> 
        
        
        <div class="featurette" id="3.3.5">
             <h2 class="featurette-heading">3.3.5                Spustenie webovej aplikácie</h2>
            <p class="lead2">
Pri spustení aplikácie záleží na tom, či ide o jej prvé alebo ďalšie, už opakované  spustenie. Jeho priebeh popisujeme výpisom príkazových riadkov a vývojovým diagramom (obrázok 5).
<br> <br> 
<b>Prvé spustenie aplikácie</b>

<p class="scripty">
<b>Povolenie portu 3000, na ktorom aplikácia komunikuje </b>
<br> 
&bull;     iptables -A IN_public_allow -p tcp -m tcp --dport 3000 -m conntrack --ctstate NEW -j ACCEPT<br> 
<b>Nastavenie priečinka, v ktorom sa aplikácia nachádza </b><br> 
&bull;    cd /home/dark/applications/apache-dashboard<br> 
<b>Spustenie MongoDB databázy</b><br>  
&bull;     mongod --dbpath ./data<br> 
<b>Generovanie záznamov</b><br> 
&bull;    npm run generate<br> 
<b>Spustenie aplikácie</b> <br> 
&bull;     npm start<br> 
</p>
<br> <br> 

<b>Druhé a ďalšie spustenie </b>   
<p class="scripty">

<b>Povolenie portu 3000, na ktorom aplikácia komunikuje </b><br> 
&bull;     iptables -A IN_public_allow -p tcp -m tcp --dport 3000 -m conntrack --ctstate NEW -j ACCEPT<br> 
<b>Nastavenie priečinka, v ktorom sa aplikácia nachádza </b><br> 
&bull;     cd /home/dark/applications/apache-dashboard</b><br> 
<b>Spustenie MongoDB databázy </b><br> 
&bull;     nohup mongod --dbpath ./data &<br> 
<b>Spustenie aplikácie </b><br> 
&bull;    nohup npm start &<br> 
</p>

<br>
        <center>
     Obrázok 5:  Vývojový diagram spustenia webovej aplikácie <br> 
<img src="_grf/apache/image005.png">
           </center>  
            </p>
        </div>

        <hr> 
        
        
        <div class="featurette" id="3.4">
             <h2 class="featurette-heading">3.4               Porovnanie rýchlosti spracovania záznamov</h2>
            <p class="lead2">
 Porovnanie je riešené podobne ako štatistické spracovanie záznamov, t. j. modulom Výkonnostné testy.            
            </p>
        </div>

        <hr> 

        <!-- Pagination -->
        <div class="row text-center">
            <div class="col-lg-12">
                <ul class="pagination">
                    <li>
                        <a href="cl1.html">&laquo;</a>
                    </li>
                    <li>
                        <a href="cl1.html">1</a>
                    </li>
                    <li class="active">
                        <a href="cl2.html">2</a>
                    </li>
                    <li>
                        <a href="cl3.html">3</a>
                    </li>
                    <li>
                        <a href="cl4.html">4</a>
                    </li>
                    <li>
                        <a href="cl3.html">&raquo;</a>
                    </li>
                </ul>
            </div>
        </div>

        <hr>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; NoSQL.sk 2016 | <a href="mailto:admin@nosql.sk">admin(@)nosql.sk</a>  
                    
                    <a  href="http://www.facebook.com/michal.szekely" target="_blank">
                       <i class="fa fa-facebook-square" style="font-size:20px"></i></a>
  
                    <a  href="https://www.linkedin.com/in/michal-szekely-435076a?trk=hp-identity-name"  target="_blank" >
                      <i class="fa fa-linkedin-square" style="font-size:20px"></i></a>
                     </p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
